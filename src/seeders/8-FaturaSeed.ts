import { DataSource } from 'typeorm';

export class FaturaSeed {
  public async run(dataSource: DataSource): Promise<void> {
    const queryRunner = dataSource.createQueryRunner();

    await queryRunner.connect();
    await queryRunner.startTransaction();

    try {
      // Inserir faturas
      await queryRunner.query(`
        INSERT INTO fatura (
          id, contrato_associado_id, mes_referencia, data_vencimento,
          valor_base_aluguel, leitura_anterior_energia, leitura_atual_energia,
          consumo_energia_kwh, valor_energia, leitura_anterior_gas, leitura_atual_gas,
          consumo_gas_m3, valor_gas, outros_valores, descricao_outros_valores,
          valor_total_pagar, status_pagamento, data_pagamento, valor_pago,
          comprovante_pagamento_url, observacoes
        ) VALUES 
        (
          'f47ac10b-58cc-4372-a567-0e02b2c3d479',
          'c47ac10b-58cc-4372-a567-0e02b2c3d479',
          '2024-06-01',
          '2024-06-10',
          800.00,
          1250.50,
          1380.75,
          130.25,
          97.69,
          45.20,
          48.50,
          3.30,
          11.55,
          0.00,
          NULL,
          909.24,
          'Pago',
          '2024-06-09 14:30:00',
          909.24,
          'https://exemplo.com/comprovante_fatura1.pdf',
          'Pagamento realizado via PIX'
        ),
        (
          'f47ac10b-58cc-4372-a567-0e02b2c3d480',
          'c47ac10b-58cc-4372-a567-0e02b2c3d479',
          '2024-05-01',
          '2024-05-10',
          800.00,
          1120.25,
          1250.50,
          130.25,
          97.69,
          42.10,
          45.20,
          3.10,
          10.85,
          25.00,
          'Taxa de limpeza da área comum',
          933.54,
          'Pago',
          '2024-05-08 09:15:00',
          933.54,
          'https://exemplo.com/comprovante_fatura2.pdf',
          'Pagamento em dia'
        ),
        (
          'f47ac10b-58cc-4372-a567-0e02b2c3d481',
          'c47ac10b-58cc-4372-a567-0e02b2c3d480',
          '2024-06-01',
          '2024-06-15',
          1500.00,
          2150.80,
          2280.40,
          129.60,
          106.27,
          78.50,
          82.30,
          3.80,
          15.96,
          50.00,
          'Condomínio',
          1672.23,
          'Pago',
          '2024-06-14 16:45:00',
          1672.23,
          'https://exemplo.com/comprovante_fatura3.pdf',
          'Pagamento via transferência bancária'
        ),
        (
          'f47ac10b-58cc-4372-a567-0e02b2c3d482',
          'c47ac10b-58cc-4372-a567-0e02b2c3d481',
          '2024-06-01',
          '2024-06-05',
          750.00,
          890.25,
          985.50,
          95.25,
          74.30,
          35.80,
          38.20,
          2.40,
          9.12,
          0.00,
          NULL,
          833.42,
          'Pendente',
          NULL,
          NULL,
          NULL,
          'Aguardando pagamento'
        ),
        (
          'f47ac10b-58cc-4372-a567-0e02b2c3d483',
          'c47ac10b-58cc-4372-a567-0e02b2c3d482',
          '2024-06-01',
          '2024-06-20',
          600.00,
          450.75,
          520.25,
          69.50,
          52.82,
          18.50,
          20.80,
          2.30,
          8.28,
          15.00,
          'Internet',
          676.10,
          'Pago',
          '2024-06-19 11:20:00',
          676.10,
          'https://exemplo.com/comprovante_fatura4.pdf',
          'Estudante sempre pontual'
        ),
        (
          'f47ac10b-58cc-4372-a567-0e02b2c3d484',
          'c47ac10b-58cc-4372-a567-0e02b2c3d479',
          '2024-04-01',
          '2024-04-10',
          800.00,
          990.00,
          1120.25,
          130.25,
          97.69,
          39.80,
          42.10,
          2.30,
          8.05,
          0.00,
          NULL,
          905.74,
          'Vencido',
          NULL,
          NULL,
          NULL,
          'Fatura em atraso - aplicar multa'
        ),
        (
          'f47ac10b-58cc-4372-a567-0e02b2c3d485',
          'c47ac10b-58cc-4372-a567-0e02b2c3d480',
          '2024-05-01',
          '2024-05-15',
          1500.00,
          2020.50,
          2150.80,
          130.30,
          106.85,
          75.20,
          78.50,
          3.30,
          13.86,
          50.00,
          'Condomínio',
          1670.71,
          'Pago',
          '2024-05-13 13:10:00',
          1670.71,
          'https://exemplo.com/comprovante_fatura5.pdf',
          'Pagamento antecipado'
        ),
        (
          'f47ac10b-58cc-4372-a567-0e02b2c3d486',
          'c47ac10b-58cc-4372-a567-0e02b2c3d481',
          '2024-05-01',
          '2024-05-05',
          750.00,
          795.00,
          890.25,
          95.25,
          74.30,
          33.50,
          35.80,
          2.30,
          8.74,
          0.00,
          NULL,
          833.04,
          'Pago',
          '2024-05-04 10:30:00',
          833.04,
          'https://exemplo.com/comprovante_fatura6.pdf',
          'Sempre paga antes do vencimento'
        ),
        (
          'f47ac10b-58cc-4372-a567-0e02b2c3d487',
          'c47ac10b-58cc-4372-a567-0e02b2c3d482',
          '2024-05-01',
          '2024-05-20',
          600.00,
          380.50,
          450.75,
          70.25,
          53.39,
          16.20,
          18.50,
          2.30,
          8.28,
          15.00,
          'Internet',
          676.67,
          'Pago',
          '2024-05-18 15:45:00',
          676.67,
          'https://exemplo.com/comprovante_fatura7.pdf',
          'Pagamento via boleto'
        ),
        (
          'f47ac10b-58cc-4372-a567-0e02b2c3d488',
          'c47ac10b-58cc-4372-a567-0e02b2c3d479',
          '2024-07-01',
          '2024-07-10',
          800.00,
          1380.75,
          1510.25,
          129.50,
          97.13,
          48.50,
          51.80,
          3.30,
          11.55,
          0.00,
          NULL,
          908.68,
          'Pendente',
          NULL,
          NULL,
          NULL,
          'Fatura do mês atual'
        );
      `);

      await queryRunner.commitTransaction();
      console.log('✅ FaturaSeed executado com sucesso!');
    } catch (error) {
      await queryRunner.rollbackTransaction();
      console.error('❌ Erro ao executar FaturaSeed:', error);
      throw error;
    } finally {
      await queryRunner.release();
    }
  }
}

